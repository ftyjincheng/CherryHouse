{"version":3,"sources":["webpack:///F:/Code/cherryHouse/CherryHouseVUE/ec-canvas/ec-canvas.vue?59d3","webpack:///F:/Code/cherryHouse/CherryHouseVUE/ec-canvas/ec-canvas.vue?554f","webpack:///F:/Code/cherryHouse/CherryHouseVUE/ec-canvas/ec-canvas.vue?30f9","webpack:///F:/Code/cherryHouse/CherryHouseVUE/ec-canvas/ec-canvas.vue?24f1","uni-app:///ec-canvas/ec-canvas.vue","webpack:///F:/Code/cherryHouse/CherryHouseVUE/ec-canvas/ec-canvas.vue?2f0a","webpack:///F:/Code/cherryHouse/CherryHouseVUE/ec-canvas/ec-canvas.vue?c308"],"names":[],"mappings":";;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAsH;AACtH;AAC6D;AACL;AACa;;;AAGrE;AACoL;AACpL,gBAAgB,6LAAU;AAC1B,EAAE,+EAAM;AACR,EAAE,oFAAM;AACR,EAAE,6FAAe;AACjB;AACA;AACA;AACA;AACA;AACA,EAAE,wFAAU;AACZ;AACA;;AAEA;AACe,gF;;;;;;;;;;;;ACvBf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;ACjCA;AAAA;AAAA;AAAA;AAA8qB,CAAgB,msBAAG,EAAC,C;;;;;;;;;;;;;;;;;;;;;;ACUlsB;AACA,iF;;;;;;;;;AACA,QACA,iCACA,mBACA,mBACA,yCAEA,yBACA,aACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,KAFA,MAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,C;;AAEA;AACA,MADA,kBACA;AACA;AACA,2BADA;;AAGA,GALA;;AAOA,gBAPA;AAQA;AACA;AACA,kBADA;AAEA,0BAFA,EADA;;AAKA;AACA,kBADA,EALA;;AAQA;AACA,mBADA;AAEA,oBAFA,EARA,EARA;;;AAqBA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,GA9BA;AA+BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sCADA;;;AAIA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,OAJA,MAIA;AACA;;AAEA;AACA;AACA;AACA,SAHA,MAGA;AACA;AACA;AACA;AACA;AACA,KA7BA;;AA+BA,gBA/BA,wBA+BA,QA/BA,EA+BA;AACA;AACA;AACA;AACA;AACA;AACA,OAFA,EAJA,CAMA;;AAEA;AACA;AACA;AACA;AACA;AACA,SAFA,MAEA;AACA;AACA,SAFA,MAEA;AACA;AACA;AACA,4BADA;AAEA,8BAFA;AAGA,gCAHA;AAIA,kCAJA,CAIA;AAJA,aADA;;;AASA;AACA,OAhBA,EAgBA,IAhBA;AAiBA,KA1DA;;AA4DA,gBA5DA,wBA4DA,QA5DA,EA4DA;AACA;AACA;AACA;AACA,kBADA;AAEA,kBAFA;AAGA,UAHA,CAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAFA;;AAIA;AACA;AACA,SAFA,MAEA;AACA;AACA,SAFA,MAEA;AACA;AACA;AACA,4BADA;AAEA,gCAFA;AAGA,kCAHA;AAIA,4BAJA,EADA;;;AAQA;AACA,OA7BA;AA8BA,KA7FA;;AA+FA,wBA/FA,gCA+FA,GA/FA,EA+FA;AACA;AACA;AACA;AACA;AACA,oBADA;AAEA,oBAFA;AAGA,YAHA,CAGA;AACA;AACA;AACA;AACA,SAPA;AAQA,OAXA,MAWA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,SAFA;AAGA;AACA,KArHA;;AAuHA,cAvHA,sBAuHA,CAvHA,EAuHA;AACA;AACA;AACA;AACA;AACA,sBADA;AAEA,sBAFA;;AAIA;AACA,sBADA;AAEA,sBAFA;;AAIA;AACA;AACA,KArIA;;AAuIA,aAvIA,qBAuIA,CAvIA,EAuIA;AACA;AACA;AACA;AACA;AACA,sBADA;AAEA,sBAFA;;AAIA;AACA;AACA,KAjJA;;AAmJA,YAnJA,oBAmJA,CAnJA,EAmJA;AACA;AACA;AACA;AACA;AACA,sBADA;AAEA,sBAFA;;AAIA;AACA,sBADA;AAEA,sBAFA;;AAIA;AACA;AACA,KAjKA,EA/BA,E;;;;;;;;;;;;;ACjDA;AAAA;AAAA;AAAA;AAA89B,CAAgB,w9BAAG,EAAC,C;;;;;;;;;;;ACAl/B;AACA,OAAO,KAAU,EAAE,kBAKd","file":"ec-canvas/ec-canvas.js","sourcesContent":["import { render, staticRenderFns, recyclableRender, components } from \"./ec-canvas.vue?vue&type=template&id=18451521&\"\nvar renderjs\nimport script from \"./ec-canvas.vue?vue&type=script&lang=js&\"\nexport * from \"./ec-canvas.vue?vue&type=script&lang=js&\"\nimport style0 from \"./ec-canvas.vue?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!C:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\runtime\\\\componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"ec-canvas/ec-canvas.vue\"\nexport default component.exports","export * from \"-!C:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\templateLoader.js??vue-loader-options!C:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--16-0!C:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\template.js!C:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-uni-app-loader\\\\page-meta.js!C:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!C:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./ec-canvas.vue?vue&type=template&id=18451521&\"","var components\nvar render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  if (!_vm._isMounted) {\n    _vm.e0 = function($event) {\n      _vm.ec.disableTouch ? \"\" : \"touchStart\"\n    }\n\n    _vm.e1 = function($event) {\n      _vm.ec.disableTouch ? \"\" : \"touchMove\"\n    }\n\n    _vm.e2 = function($event) {\n      _vm.ec.disableTouch ? \"\" : \"touchEnd\"\n    }\n\n    _vm.e3 = function($event) {\n      _vm.ec.disableTouch ? \"\" : \"touchStart\"\n    }\n\n    _vm.e4 = function($event) {\n      _vm.ec.disableTouch ? \"\" : \"touchMove\"\n    }\n\n    _vm.e5 = function($event) {\n      _vm.ec.disableTouch ? \"\" : \"touchEnd\"\n    }\n  }\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!C:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!C:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--12-1!C:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!C:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!C:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./ec-canvas.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!C:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!C:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--12-1!C:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!C:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!C:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./ec-canvas.vue?vue&type=script&lang=js&\"","<template>\r\n<view>\r\n<!-- 新的：接口对其了H5 -->\r\n<canvas v-if=\"isUseNewCanvas\" type=\"2d\" class=\"ec-canvas\" :canvas-id=\"canvasId\" @init=\"init\" @touchstart=\"ec.disableTouch ? '' : 'touchStart'\" @touchmove=\"ec.disableTouch ? '' : 'touchMove'\" @touchend=\"ec.disableTouch ? '' : 'touchEnd'\"></canvas>\r\n<!-- 旧的 -->\r\n<canvas v-else class=\"ec-canvas\" :canvas-id=\"canvasId\" @init=\"init\" @touchstart=\"ec.disableTouch ? '' : 'touchStart'\" @touchmove=\"ec.disableTouch ? '' : 'touchMove'\" @touchend=\"ec.disableTouch ? '' : 'touchEnd'\"></canvas>\r\n</view>\r\n</template>\r\n\r\n<script>\r\nimport WxCanvas from './wx-canvas';\r\nimport * as echarts from './echarts';\r\nlet ctx;\r\nfunction compareVersion(v1, v2) {\n  v1 = v1.split('.');\n  v2 = v2.split('.');\n  const len = Math.max(v1.length, v2.length);\n\n  while (v1.length < len) {\n    v1.push('0');\n  }\n\n  while (v2.length < len) {\n    v2.push('0');\n  }\n\n  for (let i = 0; i < len; i++) {\n    const num1 = parseInt(v1[i]);\n    const num2 = parseInt(v2[i]);\n\n    if (num1 > num2) {\n      return 1;\n    } else if (num1 < num2) {\n      return -1;\n    }\n  }\n\n  return 0;\n}\r\nfunction wrapTouch(event) {\n  for (let i = 0; i < event.touches.length; ++i) {\n    const touch = event.touches[i];\n    touch.offsetX = touch.x;\n    touch.offsetY = touch.y;\n  }\n\n  return event;\n}\r\n\r\nexport default {\n  data() {\n    return {\n      isUseNewCanvas: false\n    };\n  },\n\n  components: {},\n  props: {\n    canvasId: {\n      type: String,\n      default: 'ec-canvas'\n    },\n    ec: {\n      type: Object\n    },\n    forceUseOldCanvas: {\n      type: Boolean,\n      default: false\n    }\n  },\n  mounted: function () {\n    if (!this.ec) {\n      console.warn('组件需绑定 ec 变量，例：<ec-canvas id=\"mychart-dom-bar\" ' + 'canvas-id=\"mychart-bar\" ec=\"{{ ec }}\"></ec-canvas>');\n      return;\n    }\n\n    if (!this.ec.lazyLoad) {\n      this.init();\n    }\n  },\n  methods: {\n    init: function (callback) {\n      const version = uni.getSystemInfoSync().SDKVersion;\n      const canUseNewCanvas = compareVersion(version, '2.9.0') >= 0;\n      const forceUseOldCanvas = this.forceUseOldCanvas;\n      const isUseNewCanvas = canUseNewCanvas && !forceUseOldCanvas;\n      this.setData({\n        isUseNewCanvas\n      });\n\n      if (forceUseOldCanvas && canUseNewCanvas) {\n        console.warn('开发者强制使用旧canvas,建议关闭');\n      }\n\n      if (isUseNewCanvas) {\n        // console.log('微信基础库版本大于2.9.0，开始使用<canvas type=\"2d\"/>');\n        // 2.9.0 可以使用 <canvas type=\"2d\"></canvas>\n        this.initByNewWay(callback);\n      } else {\n        const isValid = compareVersion(version, '1.9.91') >= 0;\n\n        if (!isValid) {\n          console.error('微信基础库版本过低，需大于等于 1.9.91。' + '参见：https://github.com/ecomfe/echarts-for-weixin' + '#%E5%BE%AE%E4%BF%A1%E7%89%88%E6%9C%AC%E8%A6%81%E6%B1%82');\n          return;\n        } else {\n          console.warn('建议将微信基础库调整大于等于2.9.0版本。升级后绘图将有更好性能');\n          this.initByOldWay(callback);\n        }\n      }\n    },\n\n    initByOldWay(callback) {\n      // 1.9.91 <= version < 2.9.0：原来的方式初始化\n      ctx = uni.createCanvasContext(this.canvasId, this);\n      const canvas = new WxCanvas(ctx, this.canvasId, false);\n      echarts.setCanvasCreator(() => {\n        return canvas;\n      }); // const canvasDpr = wx.getSystemInfoSync().pixelRatio // 微信旧的canvas不能传入dpr\n\n      const canvasDpr = 1;\n      var query = uni.createSelectorQuery().in(this);\n      query.select('.ec-canvas').boundingClientRect(res => {\n        if (typeof callback === 'function') {\n          this.chart = callback(canvas, res.width, res.height, canvasDpr);\n        } else if (this.ec && typeof this.ec.onInit === 'function') {\n          this.chart = this.ec.onInit(canvas, res.width, res.height, canvasDpr);\n        } else {\n          this.$emit('init', {\n            detail: {\n              canvas: canvas,\n              width: res.width,\n              height: res.height,\n              canvasDpr: canvasDpr // 增加了dpr，可方便外面echarts.init\n\n            }\n          });\n        }\n      }).exec();\n    },\n\n    initByNewWay(callback) {\n      // version >= 2.9.0：使用新的方式初始化\n      const query = uni.createSelectorQuery().in(this);\n      query.select('.ec-canvas').fields({\n        node: true,\n        size: true\n      }).exec(res => {\n        const canvasNode = res[0].node;\n        this.canvasNode = canvasNode;\n        const canvasDpr = uni.getSystemInfoSync().pixelRatio;\n        const canvasWidth = res[0].width;\n        const canvasHeight = res[0].height;\n        const ctx = canvasNode.getContext('2d');\n        const canvas = new WxCanvas(ctx, this.canvasId, true, canvasNode);\n        echarts.setCanvasCreator(() => {\n          return canvas;\n        });\n\n        if (typeof callback === 'function') {\n          this.chart = callback(canvas, canvasWidth, canvasHeight, canvasDpr);\n        } else if (this.ec && typeof this.ec.onInit === 'function') {\n          this.chart = this.ec.onInit(canvas, canvasWidth, canvasHeight, canvasDpr);\n        } else {\n          this.$emit('init', {\n            detail: {\n              canvas: canvas,\n              width: canvasWidth,\n              height: canvasHeight,\n              dpr: canvasDpr\n            }\n          });\n        }\n      });\n    },\n\n    canvasToTempFilePath(opt) {\n      if (this.isUseNewCanvas) {\n        // 新版\n        const query = uni.createSelectorQuery().in(this);\n        query.select('.ec-canvas').fields({\n          node: true,\n          size: true\n        }).exec(res => {\n          const canvasNode = res[0].node;\n          opt.canvas = canvasNode;\n          uni.canvasToTempFilePath(opt);\n        });\n      } else {\n        // 旧的  \n        if (!opt.canvasId) {\n          opt.canvasId = this.canvasId;\n        }\n\n        ctx.draw(true, () => {\n          uni.canvasToTempFilePath(opt, this);\n        });\n      }\n    },\n\n    touchStart(e) {\n      if (this.chart && e.touches.length > 0) {\n        var touch = e.touches[0];\n        var handler = this.chart.getZr().handler;\n        handler.dispatch('mousedown', {\n          zrX: touch.x,\n          zrY: touch.y\n        });\n        handler.dispatch('mousemove', {\n          zrX: touch.x,\n          zrY: touch.y\n        });\n        handler.processGesture(wrapTouch(e), 'start');\n      }\n    },\n\n    touchMove(e) {\n      if (this.chart && e.touches.length > 0) {\n        var touch = e.touches[0];\n        var handler = this.chart.getZr().handler;\n        handler.dispatch('mousemove', {\n          zrX: touch.x,\n          zrY: touch.y\n        });\n        handler.processGesture(wrapTouch(e), 'change');\n      }\n    },\n\n    touchEnd(e) {\n      if (this.chart) {\n        const touch = e.changedTouches ? e.changedTouches[0] : {};\n        var handler = this.chart.getZr().handler;\n        handler.dispatch('mouseup', {\n          zrX: touch.x,\n          zrY: touch.y\n        });\n        handler.dispatch('click', {\n          zrX: touch.x,\n          zrY: touch.y\n        });\n        handler.processGesture(wrapTouch(e), 'end');\n      }\n    }\n\n  }\n};\r\n</script>\r\n<style>\r\n@import \"./ec-canvas.css\";\r\n</style>","import mod from \"-!C:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\mini-css-extract-plugin\\\\dist\\\\loader.js??ref--6-oneOf-1-0!C:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\css-loader\\\\dist\\\\cjs.js??ref--6-oneOf-1-1!C:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\stylePostLoader.js!C:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--6-oneOf-1-2!C:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\postcss-loader\\\\src\\\\index.js??ref--6-oneOf-1-3!C:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!C:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./ec-canvas.vue?vue&type=style&index=0&lang=css&\"; export default mod; export * from \"-!C:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\mini-css-extract-plugin\\\\dist\\\\loader.js??ref--6-oneOf-1-0!C:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\css-loader\\\\dist\\\\cjs.js??ref--6-oneOf-1-1!C:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\stylePostLoader.js!C:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--6-oneOf-1-2!C:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\postcss-loader\\\\src\\\\index.js??ref--6-oneOf-1-3!C:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!C:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./ec-canvas.vue?vue&type=style&index=0&lang=css&\"","// extracted by mini-css-extract-plugin\n    if(module.hot) {\n      // 1616213768336\n      var cssReload = require(\"C:/Program Files/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"hmr\":true,\"publicPath\":\"../../\",\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  "],"sourceRoot":""}